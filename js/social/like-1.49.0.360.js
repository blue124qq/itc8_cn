var Like=function(n){var t={LoggedIn:function(){return n("meta[name=gwa_authStatus]").attr("content").toLowerCase()!="logged in"?(openLoginBox(),!1):!0},setLike:function(t,i,r,u,f){n.ajax("/js/general/LikeHandler.ashx",{type:"POST",data:{action:r,buttontype:i,id:t},success:function(t){t.split("|")[0]!=="Ok"?n(u).text(resources.esp_common_error):f!=null&&f(t)}})},updateLikes:function(i,r,u,f){n.ajax("/js/general/GetLikeUsersHandler.ashx",{type:"POST",data:{action:u,buttontype:r,id:i},success:function(i){var s=n(f).parent(),h=s.find("[data-holder='hover-numberPersons']"),c=s.find("[data-holder='click-numberPersons']"),r,u,e,o;if(i.Users){r="";u="";for(e in i.Users)r+=t.getHoverItemTemplate().replace("{{DisplayName}}",i.Users[e].DisplayName),u+=t.getClickItem(i.Users[e]);o="";i.HasMore&&(o=t.getMoreLinkTemplate().replace(/{{PageIndex}}/g,i.PageIndex));h.html(t.getHoverTemplate().replace("{{Users}}",r));c.html(t.getClickTemplate().replace("{{Users}}",u).replace("{{MoreLink}}",o));n("[data-action='like-nextpage']").off("click");t.bindMoreLink()}else h.html(""),c.html("")}})},getNextLikePage:function(t,i,r,u,f){n.ajax("/js/general/GetLikeUsersHandler.ashx",{type:"POST",data:{action:r,buttontype:i,pageIndex:u,id:t},success:function(n){f!=null&&f(n)}})},bindLikeButton:function(){n("[id$=likebutton]").click(function(){var r=n(this).attr("data-action"),u=n(this).attr("data-id"),f=n(this).attr("data-buttontype"),i=n(this);return t.LoggedIn()?(t.setLike(u,f,r,i,function(e){var o=e.split("|"),s;i.attr("data-action",o[1]);i.html(o[2]);n("#number-span").html(o[3]);trackGWANetworkMessage("telligent",r.concat(" ",o[1]),"","");s=i.attr("data-update-hover");s==="true"&&t.updateLikes(u,f,r,i)}),!1):!1})},bindMoreLink:function(){n("[data-action='like-nextpage']").click(function(){var r=n(this).attr("data-action"),u=n(this).attr("data-id"),f=n(this).attr("data-buttontype"),e=n(this).attr("data-pageindex"),i=n(this);return t.getNextLikePage(u,f,r,e,function(r){var u="";for(var f in r.Users)u+=t.getClickItem(r.Users[f]);n(u).appendTo(i.parent().find("ul"));r.HasMore?i.attr("data-pageindex",r.PageIndex):i.hide()}),!1})},toggleHoverTarget:function(t){n('[data-hover="'+t+'"]').toggleClass("is-hidden")},toggleClickTarget:function(t){n('[data-click="'+t+'"]').toggleClass("is-hidden")},bindHoverAndClick:function(){n("[data-hover-target]").hover(function(){t.toggleHoverTarget(n(this).attr("data-hover-target"))});n("[data-click-target]").click(function(){t.toggleClickTarget(n(this).attr("data-click-target"))})},getClickItem:function(n){var i=t.getClickItemTemplate();return n.Function||(n.Function=""),i=i.replace(/{{ProfileUrl}}/g,n.ProfileUrl),i=i.replace(/{{AvatarToDisplay}}/g,n.AvatarToDisplay),i=i.replace(/{{DisplayName}}/g,n.DisplayName),i=i.replace(/{{SubtitleToDisplay}}/g,n.SubtitleToDisplay),i.replace(/{{UserId}}/g,n.UserId)},getHoverTemplate:function(){return'<span data-hover="numberPersons" class="is-hidden hover-up comment-count"> <ul style="padding:5px;list-style:none;">{{Users}}<\/ul><\/span>'},getHoverItemTemplate:function(){return"<li>{{DisplayName}}<\/li>"},getClickTemplate:function(){return'<span data-click="numberPersonsExtended" class="is-hidden hover-up" style="width:350px;"><div class="boxed--white" style="margin-bottom:0;"><ul class="media-list">{{Users}}<\/ul>{{MoreLink}}<\/div><\/span>'},getMoreLinkTemplate:function(){return n("#morelink-template").html()},getClickItemTemplate:function(){return n("#like-clickitem-template").html()}};return{OnReady:function(){t.bindLikeButton();t.bindHoverAndClick();t.bindMoreLink()}}}(jQuery)